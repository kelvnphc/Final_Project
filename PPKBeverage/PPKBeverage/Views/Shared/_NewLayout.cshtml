<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.css" />
    <link rel="stylesheet" href="~/css/site.css" />
    <link rel="stylesheet" href="~/css/kh.css" />
    <link rel="stylesheet" href="~/css/kh1.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <title>KELVNPHC Beverage Shop</title>
    <link rel="shortcut icon" href="./images/logo.png">
</head>
<body>
    <header>
        <nav class="navbar navbar-expand-sm navbar-toggleable-sm navbar-light border-bottom box-shadow mb-3 custom-navbar" style="margin-bottom: 0 !important;">
            <div class="container">
                <!-- Logo and Brand Name -->
                <a class="navbar-brand d-flex align-items-center" asp-area="" asp-controller="Home" asp-action="Index">
                    <img src="~/images/logo.png" alt="Logo" class="navbar-logo">
                    <span style="font-weight: bolder !important; margin-left: 10px; color: white">KELVNPHC BEVERAGE SHOP</span>
                </a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <!-- Nav pills -->
                    <ul class="navbar-nav me-auto mb-2 mb-lg-0 nav-pills">
                        <li class="nav-item">
                            <a class="nav-link @(ViewContext.RouteData.Values["Controller"].ToString() == "Home" && ViewContext.RouteData.Values["Action"].ToString() == "Index" ? "active" : "")" aria-current="page" asp-area="" asp-controller="Home" asp-action="Index">🏠Trang chủ</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link @(ViewContext.RouteData.Values["Controller"].ToString() == "KhachHang" && ViewContext.RouteData.Values["Action"].ToString() == "ListBeverage" ? "active" : "")" asp-area="" asp-controller="KhachHang" asp-action="ListBeverage">📋Danh mục sản phẩm</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link @(ViewContext.RouteData.Values["Controller"].ToString() == "GioHang" && ViewContext.RouteData.Values["Action"].ToString() == "ListCarts" ? "active" : "")" asp-area="" asp-controller="GioHang" asp-action="ListCarts">
                                &#x1F6D2; Thanh toán
                            </a>
                        </li>
                    </ul>
                    @using Microsoft.AspNetCore.Http
                    @{
                        var userName = Context.Session.GetString("UserName");
                        var hoKh = Context.Session.GetString("HoKh");
                        var tenKh = Context.Session.GetString("TenKh");
                        Context.Session.GetString("UserName");
                    }

                    <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
                        <!-- In your Razor view -->
                        @if (userName != null)
                        {
                            <li class="nav-item">
                                <span class="nav-link text-white">Xin chào,@Context.Session.GetString("UserName")</span>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link @(ViewContext.RouteData.Values["Controller"].ToString() == "KhachHang" && ViewContext.RouteData.Values["Action"].ToString() == "DangXuat" ? "active" : "")" asp-area="" asp-controller="KhachHang" asp-action="DangXuat">👋Đăng xuất</a>
                            </li>
                        }
                        else
                        {
                            <li class="nav-item">
                                <a class="nav-link @(ViewContext.RouteData.Values["Controller"].ToString() == "KhachHang" && ViewContext.RouteData.Values["Action"].ToString() == "DangNhap" ? "active" : "")" asp-area="" asp-controller="KhachHang" asp-action="DangNhap"> 🔐Đăng nhập</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link @(ViewContext.RouteData.Values["Controller"].ToString() == "KhachHang" && ViewContext.RouteData.Values["Action"].ToString() == "DangKy" ? "active" : "")" asp-area="" asp-controller="KhachHang" asp-action="DangKy"> 📝Đăng ký</a>
                            </li>
                        }


                    </ul>
                </div>
            </div>
        </nav>
    </header>

    <div class="container">
        <main role="main" class="pb-3">
            @RenderBody()
        </main>
    </div>
    <!--Use the below code snippet to provide real time updates to the live chat plugin without the need of copying and paste each time to your website when changes are made via PBX-->
    <call-us-selector phonesystem-url="https://1404.3cx.cloud" party="1openuniversity"></call-us-selector>

    <!--Incase you don't want real time updates to the live chat plugin when options are changed, use the below code snippet. Please note that each time you change the settings you will need to copy and paste the snippet code to your website-->
    <!--<call-us
    phonesystem-url="https://1404.3cx.cloud"
    style="position:fixed;font-size:16px;line-height:17px;z-index: 99999;--call-us-main-accent-color:#3397D4;--call-us-main-background-color:#FFFFFF;--call-us-plate-background-color:#373737;--call-us-plate-font-color:#E6E6E6;--call-us-main-font-color:#000000;--call-us-agent-bubble-color:#00000010;right: 20px; bottom: 20px;"
    id="wp-live-chat-by-3CX"
    minimized="false"
    animation-style="fadein"
    party="1openuniversity"
    minimized-style="bubbleright"
    allow-call="true"
    allow-video="false"
    allow-soundnotifications="true"
    enable-mute="true"
    enable-onmobile="true"
    offline-enabled="true"
    enable="true"
    ignore-queueownership="false"
    authentication="none"
    show-operator-actual-name="true"
    aknowledge-received="true"
    gdpr-enabled="false"
    message-userinfo-format="both"
    message-dateformat="both"
    lang="browser"
    button-icon-type="default"
    greeting-visibility="none"
    greeting-offline-visibility="none"
    chat-delay="2000"
    enable-direct-call="true"
    enable-ga="false"
    ></call-us>-->
    <script defer src="https://downloads-global.3cx.com/downloads/livechatandtalk/v1/callus.js" id="tcx-callus-js" charset="utf-8"></script>
     
    @if (ViewData["ShowFooter"] is bool showFooter && showFooter)
    {
        <footer class="footer">
            <div class="footer-content">
                <div class="footer-logo">
                    <!-- Logo -->
                    <img src="~/images/logo.png" alt="KELVNPHC BEVERAGE SHOP Logo" class="footer-logo-img" />
                    <p>&copy; 2024. All rights reserved.</p>
                </div>
                <div class="footer-links">
                    <h3>Liên kết nhanh</h3>
                    <ul>
                        <li><a href="/" class="footer-link">Trang chủ</a></li>
                        <li><a href="/KhachHang/ListBeverage" class="footer-link">Danh mục sản phẩm</a></li>
                        <li><a href="/" class="footer-link">Về chúng tôi</a></li>
                        <li><a href="/" class="footer-link">Liên hệ</a></li>
                        <li><a href="/" class="footer-link">Chính sách riêng tư</a></li>
                    </ul>
                </div>
                <div class="footer-social">
                    <h3>Theo dõi chúng tôi tại</h3>
                    <a href="https://www.facebook.com/profile.php?id=100014996749293" class="social-icon" target="_blank" title="Facebook">
                        <i class="fab fa-facebook-f"></i>
                    </a>
                    <a href="https://www.youtube.com/channel/UC6UpMbqgS83S8MY-S5tL28g" class="social-icon" target="_blank" title="YouTube">
                        <i class="fab fa-youtube"></i>
                    </a>
                    <a href="https://tiktok.com" class="social-icon" target="_blank" title="TikTok">
                        <i class="fab fa-tiktok"></i>
                    </a>
                    <a href="mailto:kelvnphc.it1@gmail.com" class="social-icon" target="_blank" title="Email">
                        <i class="fas fa-envelope"></i>
                    </a>
                    <div class="footer-iframe">
                        <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3919.573870101997!2d106.6950358!3d10.7672879!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x31752f15f72921df%3A0x32ab48e04707bdcd!2zMTE5IMSQLiBUcuG6p24gSMawbmcgxJDhuqFvLCBQaMaw4budbmcgQ-G6p3Ugw5RuZyBMw6NuaCwgUXXhuq1uIDEsIEjhu5MgQ2jDrSBNaW5o!5e0!3m2!1svi!2s!4v1723782583959!5m2!1svi!2s" width="650" height="250" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                    </div>
                </div>
            </div>

        </footer>
    }
    

    <style>
        .custom-navbar {
            background: #343a40;
            padding: 10px 20px;
        }

        .navbar-logo {
            height: 50px;
            width: 50px;
            border-radius: 50%; /* Make the logo circular */
            object-fit: cover; /* Ensure the image fits within the circle */
        }

        .pb-3 {
             padding-bottom: 0 !important;
        }
        .navbar-brand {
            display: flex;
            align-items: center;
        }

        .nav-link {
            font-weight: bold;
            color: white !important; /* Ensure the links stand out on the gradient background */
        }

            .nav-link.active {
                background-color: rgba(255, 255, 255, 0.3); /* Add a subtle highlight to the active link */
                border-radius: 5px;
                box-shadow: 0 0 5px #03e9f4, 0 0 15px #03e9f4;
            }

        /* Footer Styling */
        html, body {
            height: 100%;
            margin: 0;
        }

        body {
            display: flex;
            flex-direction: column;
        }

        .container {
            flex: 1; /* This allows the container to take up remaining space */
            padding: 0; /* Ensure there's no padding affecting the layout */
        }

        .footer {
            background-color: #343a40;
            color: #ffffff;
            padding: 20px 0;
            text-align: center;
            position: relative; /* Ensure it's positioned correctly */
            line-height: 40px; /* Vertically center the text there */
        }
        .footer-content {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            align-items: flex-start;
            max-width: 1200px;
            margin: 0 auto;
        }

        .footer-logo, .footer-links, .footer-social {
            flex: 1;
            margin: 10px;
        }

        .footer-logo {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .footer-logo-img {
            width: 120px; /* Adjust width as needed */
            height: auto;
            margin-bottom: 10px;
        }

        .footer-links {
            text-align: center;
        }

            .footer-links ul {
                list-style: none;
                padding: 0;
            }

                .footer-links ul li {
                    margin-bottom: 10px;
                }

                    .footer-links ul li a {
                        color: #ffffff;
                        text-decoration: none;
                        transition: color 0.3s, transform 0.3s;
                    }

                        .footer-links ul li a:hover {
                            color: #007bff;
                            transform: translateX(5px);
                        }

        .footer-social {
            text-align: center;
        }

        .social-icon {
            color: #ffffff;
            font-size: 2rem;
            margin: 0 10px;
            transition: color 0.3s, transform 0.3s, box-shadow 0.3s;
            display: inline-block;
            position: relative;
        }

            .social-icon::before {
                content: '';
                position: absolute;
                top: 50%;
                left: 50%;
                width: 0;
                height: 0;
                background-color: lightblue;
                border-radius: 50%;
                transition: width 0.3s, height 0.3s;
                transform: translate(-50%, -50%);
                z-index: -1;
            }

            .social-icon:hover::before {
                width: 120%;
                height: 120%;
            }

            .social-icon:hover {
                color: #ffffff;
                transform: scale(1.2);
                box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            }

        .footer-image, .footer-iframe {
            margin-top: 20px;
            text-align: center;
        }

            .footer-image img {
                width: 100%;
                max-width: 400px;
                height: auto;
                border-radius: 8px;
            }

            .footer-iframe iframe {
                width: 100%;
                max-width: 600px;
                height: 200px;
                border: none;
                border-radius: 8px;
            }
        /* Chat Icon */
        .chat-icon {
            position: absolute !important;
            bottom: 90px;
            right: 20px;
            background: #007bff;
            border-radius: 50%;
            padding: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            cursor: pointer;
            z-index: 1000;
        }

            .chat-icon img {
                width: 40px;
                height: 40px;
                display: block;
            }

        /* Chat container styling */
        .chat-container {
            position: absolute !important;
            top: 50%;
            bottom: 100px !important;
            right: 20px;
            width: 350px;
            height: 500px;
            border: 1px solid #ddd;
            border-radius: 10px;
            background: #ffffff;
            display: flex;
            flex-direction: column;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            overflow: hidden;
            z-index: 1000;
            transform: translateY(-50%) !important; /* Di chuyển lên giữa theo chiều dọc */
        }

        /* Chat header styling */
        .chat-header {
            background: #007bff;
            color: #ffffff;
            padding: 10px;
            display: flex;
            justify-content: flex-end;
        }

        .close-btn {
            font-size: 20px;
            cursor: pointer;
        }

        /* Chat box styling */
        .chat-box {
            flex: 1;
            padding: 10px;
            overflow-y: auto;
            background: #f5f5f5;
        }

        /* Chat messages styling */
        .chat-message {
            margin: 10px 0;
            padding: 10px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            max-width: 80%;
            word-wrap: break-word;
            clear: both;
        }
            /* User and AI icons styling */
            .chat-message .icon {
                width: 24px; /* Kích thước của icon người dùng và AI */
                height: 24px;
                border-radius: 50%;
                background: #ffffff;
            }

            /* User message styling */
            .chat-message.user .icon {
                margin-left: 10px;
            }

            /* AI message styling */
            .chat-message.ai .icon {
                margin-right: 10px;
            }
        /* Chat Icon */
        .chat-icon-img {
            width: 30px; /* Kích thước của icon chat */
            height: 30px;
        }

            /* User message styling */
            .chat-message.user {
                justify-content: flex-end;
                text-align: right;
                background: #007bff;
                color: #ffffff;
                margin-left: auto;
            }

            /* AI message styling */
            .chat-message.ai {
                justify-content: flex-start;
                text-align: left;
                background: #e9ecef;
                color: #000000;
                margin-right: auto;
            }

        /* Chat input styling */
        .chat-input {
            display: flex;
            padding: 10px;
            border-top: 1px solid #ddd;
            background: #ffffff;
        }

            .chat-input input {
                flex: 1;
                padding: 10px;
                border: 1px solid #ddd;
                border-radius: 20px;
                font-size: 16px;
                outline: none;
            }

            .chat-input button {
                padding: 10px;
                margin-left: 10px;
                border: none;
                background-color: #007bff;
                color: #ffffff;
                border-radius: 20px;
                font-size: 16px;
                cursor: pointer;
                outline: none;
            }

                .chat-input button:hover {
                    background-color: #0056b3;
                }

        /* Scrollbar styling */
        .chat-box::-webkit-scrollbar {
            width: 8px;
        }

        .chat-box::-webkit-scrollbar-thumb {
            background-color: #007bff;
            border-radius: 10px;
        }

        .chat-box::-webkit-scrollbar-track {
            background-color: #f5f5f5;
        }

    </style>

    <!-- Load jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- Load Slick Carousel -->
    <script src="https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js" integrity="sha512-BNaRQnYJYiPSqHHDb58B0yaPfCu+Wgds8Gp/gU33kqBtgNS4tSPHuGibyoeqMV/TJlSKda6FXzoEyYGjTe+vXA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script>
        $(document).ready(function () {
            $('.slide').slick({
                infinite: true,
                slidesToShow: 1,
                slidesToScroll: 1,
                autoplay: true,
                autoplaySpeed: 2000,
                fade: true,
                dots: true,
                cssEase: 'linear',
                prevArrow: "<button type='button' class='slick-prev slick-arrows'><i class='fa fa-angle-left' aria-hidden='true'></i></button>",
                nextArrow: "<button type='button' class='slick-next slick-arrows'><i class='fa fa-angle-right' aria-hidden='true'></i></button>",
                responsive: [
                    {
                        breakpoint: 1201,
                        settings: {
                            arrows: false,
                            draggable: true,
                            fade: false,
                            dots: true,
                        }
                    }
                ]
            });
        });
        $(document).ready(function () {
            // Giả sử bạn lưu tên khách hàng trong sessionStorage sau khi đăng nhập thành công
            var customerName = sessionStorage.getItem('customerName');

            if (customerName) {
                $('#loginLink').text('🔐 Đăng nhập');
                $('#customerName').text(' (Xin chào, ' + customerName + ')').show();
            } else {
                $('#loginLink').text('🔐 Đăng nhập');
                $('#customerName').hide();
            }
        });
        function toggleChat() {
            const chatContainer = document.getElementById('chatContainer');
            if (chatContainer.style.display === 'none') {
                chatContainer.style.display = 'flex';
            } else {
                chatContainer.style.display = 'none';
            }
        }

        async function sendMessage() {
            const query = document.getElementById('chatInput').value;
            if (!query.trim()) return;

            // Add user's message to chatbox
            const chatBox = document.getElementById('chatBox');
            const userMessage = document.createElement('div');
            userMessage.className = 'chat-message user';
            const userIcon = document.createElement('img');
            userIcon.src = 'https://icons.veryicon.com/png/o/miscellaneous/two-color-icon-library/user-286.png'; // Thay đường dẫn icon người dùng
            userIcon.className = 'icon';
            userMessage.appendChild(userIcon);
            const userText = document.createElement('span');
            userText.textContent = query;
            userMessage.appendChild(userText);
            chatBox.appendChild(userMessage);

            // Clear input field
            document.getElementById('chatInput').value = '';

            // Send request to API
            const response = await fetch(`/UseGemini?query=${encodeURIComponent(query)}`);
            const text = await response.text();

            // Add AI's response to chatbox
            const aiMessage = document.createElement('div');
            aiMessage.className = 'chat-message ai';
            const aiIcon = document.createElement('img');
            aiIcon.src = 'https://pngimagesfree.com/wp-content/uploads/Gemini-Ai-Logo-SVG-Vector--1007x1024.png'; // Thay đường dẫn logo Gemini
            aiIcon.className = 'icon';
            aiMessage.appendChild(aiIcon);
            const aiText = document.createElement('span');
            aiText.textContent = text;
            aiMessage.appendChild(aiText);
            chatBox.appendChild(aiMessage);

            // Scroll to bottom of chatbox
            chatBox.scrollTop = chatBox.scrollHeight;
        }
        //PDF PRINTER
        document.getElementById("printPDF").addEventListener("click", function () {
            // Lấy phần tử cần in PDF
            const element = document.getElementById("order-details");

            // Sử dụng html2canvas để chuyển nội dung thành hình ảnh
            html2canvas(element).then(function (canvas) {
                const imgData = canvas.toDataURL('image/png');
                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF();

                // Tính toán chiều rộng và chiều cao của PDF
                const imgWidth = 190; // Độ rộng hình ảnh trong PDF
                const pageHeight = pdf.internal.pageSize.height;
                const imgHeight = canvas.height * imgWidth / canvas.width;
                let heightLeft = imgHeight;
                let position = 10;

                // Thêm hình ảnh vào PDF
                pdf.addImage(imgData, 'PNG', 10, position, imgWidth, imgHeight);
                heightLeft -= pageHeight;

                // Xử lý trường hợp nội dung lớn hơn một trang
                while (heightLeft >= 0) {
                    position = heightLeft - imgHeight;
                    pdf.addPage();
                    pdf.addImage(imgData, 'PNG', 10, position, imgWidth, imgHeight);
                    heightLeft -= pageHeight;
                }

                // Xuất PDF
                pdf.save('ChiTietDonHang.pdf');
            });
        });
        function openChat() {
            // Thay đổi URL này theo đúng đường dẫn của dịch vụ chat của bạn
            window.open("https://1404.3cx.cloud/phucluuvan", "_blank");
        }
    </script>
    @RenderSection("Scripts", required: false)
</body>
</html>
